{"ast":null,"code":"import axios from \"@/axios\";\nimport $ from \"jquery\";\nimport func from \"../func.js\";\nexport default {\n  name: \"FixCost\",\n  components: {// autocomplete\n  },\n\n  data() {\n    return {\n      func: func,\n      product_detail: [],\n      product_cost_data: [],\n      product_list_data: [],\n      rubber_grade: [],\n      fixCostData: {\n        fixcost_id: \"\",\n        job_type_id: \"\",\n        // link to product_type.job_type_id\n        production_type_id: \"\",\n        // link to product_detail.production_type_id\n        product_list_id: \"\",\n        rub_grade_id: \"\",\n        price1: \"\",\n        price2: \"\"\n      },\n      fixCostData_edit: {\n        fixcost_id: \"\",\n        job_type_id: \"\",\n        // link to product_type.job_type_id\n        production_type_id: \"\",\n        // link to product_detail.production_type_id\n        product_list_id: \"\",\n        rub_grade_id: \"\",\n        price1: \"\",\n        price2: \"\"\n      }\n    };\n  },\n\n  beforeUnmount() {\n    sessionStorage.clear();\n  },\n\n  created() {},\n\n  mounted() {\n    this.loadDefaultData(); // this.getRubbergrade();\n  },\n\n  methods: {\n    clearSelect2() {\n      $(document).ready(() => {\n        $(\"#productlist1\").val(\"\");\n      });\n    },\n\n    onSelect2_1() {\n      $(document).ready(() => {\n        $(\"#productlist1\").select2({\n          theme: \"bootstrap-5\",\n          closeOnSelect: true,\n          width: \"100%\",\n          dropdownParent: $(\"#productlist1\").parent(),\n          placeholder: \"--- เลือกรายการสินค้า ---\"\n        });\n        $(\"#productlist1\").on(\"select2:select\", e => {\n          let data = e.params.data;\n          this.fixCostData.product_list_id = data.id;\n        });\n      });\n    },\n\n    onSelect2_2() {\n      $(document).ready(() => {\n        $(\"#productlist2\").select2({\n          theme: \"bootstrap-5\",\n          closeOnSelect: true,\n          width: \"100%\",\n          dropdownParent: $(\"#productlist2\").parent(),\n          placeholder: \"--- เลือกรายการสินค้า ---\"\n        });\n        $(\"#productlist2\").on(\"select2:select\", e => {\n          let data = e.params.data;\n          this.fixCostData_edit.product_list_id = data.id;\n        });\n      });\n    },\n\n    loadDefaultData() {\n      this.getRubbergrade();\n      this.getProductCost();\n    },\n\n    async newFixCost() {\n      if (confirm(\"ยืนยันการบันทึกข้อมูล ?\") == true) {\n        await axios.post(`productcost/new`, this.fixCostData).then(() => {\n          this.fixCostData = {\n            fixcost_id: \"\",\n            job_type_id: \"\",\n            // link to product_type.job_type_id\n            production_type_id: \"\",\n            // link to product_detail.production_type_id\n            product_list_id: \"\",\n            rub_grade_id: \"\",\n            price1: \"\",\n            price2: \"\"\n          };\n          func.hideModal(\"fixCost\");\n          $(\"#showproductcost\").DataTable().destroy(); //--- ทำลาย Datatable\n\n          this.getProductCost();\n          console.log(\"Process success!\");\n        }).catch(error => {\n          console.log(error);\n        });\n      }\n    },\n\n    getFixCost(val) {\n      this.getProductDetail(val.job_type_id);\n      this.getProductList(val.production_type_id);\n      this.fixCostData_edit.fixcost_id = val.fixcost_id;\n      this.fixCostData_edit.job_type_id = val.job_type_id;\n      this.fixCostData_edit.production_type_id = val.production_type_id;\n      this.fixCostData_edit.product_list_id = val.product_list_id;\n      this.fixCostData_edit.rub_grade_id = val.rub_grade_id;\n      this.fixCostData_edit.price1 = val.price1;\n      this.fixCostData_edit.price2 = val.price2;\n      func.showModal(\"editfixCost\");\n      this.onSelect2_2();\n    },\n\n    async editFixCost() {\n      if (confirm(\"ยืนยันการเปลี่ยนแปลงข้อมูล ?\") == true) {\n        await axios.post(`productcost/update`, this.fixCostData_edit).then(() => {\n          this.fixCostData_edit = {\n            fixcost_id: \"\",\n            job_type_id: \"\",\n            // link to product_type.job_type_id\n            production_type_id: \"\",\n            // link to product_detail.production_type_id\n            product_list_id: \"\",\n            rub_grade_id: \"\",\n            price1: \"\",\n            price2: \"\"\n          };\n          func.hideModal(\"editfixCost\"); // $(\"#showproductcost\").DataTable().destroy(); //--- ทำลาย Datatable\n\n          this.getProductCost();\n        });\n      }\n    },\n\n    getProductCost() {\n      axios.get(`productcost/read`).then(response => {\n        this.product_cost_data = response.data; // console.log(response.data);\n\n        $(document).ready(function () {\n          $(\"#showproductcost\").DataTable({\n            scrollY: \"350px\",\n            bJQueryUI: true,\n            sPaginationType: \"full_numbers\",\n            \"destroy\": true,\n            language: {\n              decimal: \"\",\n              emptyTable: \"ไม่พบการข้อมูลจากฐานข้อมูล\",\n              info: \"พบข้อมูล _TOTAL_ เรคอร์ด\",\n              // \"info\": \"แสดง _START_ - _END_ แถว จากทั้งหมด _TOTAL_ แถว\",\n              infoEmpty: \"ไม่พบข้อมูลที่ค้นหา\",\n              infoFiltered: \"(จากข้อมูลทั้งหมด _MAX_ เรคอร์ด)\",\n              infoPostFix: \"\",\n              thousands: \",\",\n              lengthMenu: \"แสดงครั้งละ _MENU_ เรคอร์ด\",\n              loadingRecords: \"Loading...\",\n              processing: \"\",\n              search: \"ค้นหาข้อมูล:\",\n              zeroRecords: \"ไม่พบข้อมูลที่ค้นหา\",\n              paginate: {\n                first: \"หน้าแรก\",\n                last: \"หน้าสุดท้าย\",\n                next: \"ต่อไป\",\n                previous: \"ย้อนกลับ\"\n              },\n              aria: {\n                sortAscending: \": activate to sort column ascending\",\n                sortDescending: \": activate to sort column descending\"\n              }\n            }\n          });\n        });\n      });\n    },\n\n    getProductDetail(val) {\n      axios.get(`productdetail/search/${val}`).then(response => {\n        this.product_detail = response.data;\n      });\n    },\n\n    getProductList(val) {\n      axios.get(`productlist/search_productiontype/${val}`).then(response => {\n        this.product_list_data = response.data;\n      });\n    },\n\n    getRubbergrade() {\n      axios.get(`rubbergrade/read`).then(response => {\n        this.rubber_grade = response.data;\n      });\n    },\n\n    numFormat(e) {\n      const nf = new Intl.NumberFormat(\"th-TH\", {\n        style: \"currency\",\n        currency: \"THB\",\n        maximumFractionDigits: 2\n      }).format(e);\n      return nf;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","$","func","name","components","data","product_detail","product_cost_data","product_list_data","rubber_grade","fixCostData","fixcost_id","job_type_id","production_type_id","product_list_id","rub_grade_id","price1","price2","fixCostData_edit","beforeUnmount","sessionStorage","clear","created","mounted","loadDefaultData","methods","clearSelect2","document","ready","val","onSelect2_1","select2","theme","closeOnSelect","width","dropdownParent","parent","placeholder","on","e","params","id","onSelect2_2","getRubbergrade","getProductCost","newFixCost","confirm","post","then","hideModal","DataTable","destroy","console","log","catch","error","getFixCost","getProductDetail","getProductList","showModal","editFixCost","get","response","scrollY","bJQueryUI","sPaginationType","language","decimal","emptyTable","info","infoEmpty","infoFiltered","infoPostFix","thousands","lengthMenu","loadingRecords","processing","search","zeroRecords","paginate","first","last","next","previous","aria","sortAscending","sortDescending","numFormat","nf","Intl","NumberFormat","style","currency","maximumFractionDigits","format"],"sourceRoot":"","sources":["D:\\Project-vue\\SPR-PROJECT\\main-app-test\\src\\components\\productFixcost.vue"],"sourcesContent":["<template>\r\n     <!-- Modal ในส่วนของการเพิ่มข้อมูลใหม่ -->\r\n     <div class=\"modal fade shadow rounded-3\" id=\"fixCost\" tabindex=\"-1\">\r\n          <div class=\"modal-dialog\">\r\n               <div class=\"modal-content\">\r\n                    <div class=\"modal-header bg-primary bg-opacity-75\">\r\n                         <h1 class=\"modal-title fs-5\" id=\"exampleModalLabel\" style=\"color: white\">\r\n                              กำหนดราคาสินค้า\r\n                         </h1>\r\n                         <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                    </div>\r\n                    <div class=\"modal-body\">\r\n                         <form>\r\n                              <!-- <div class=\"form-floating mb-2\">\r\n                                   <input type=\"text\" class=\"form-control\" required placeholder=\"รหัสราคา\">\r\n                                   <label for=\"floatingInput\">รหัสราคา</label>\r\n                              </div> -->\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label>ประเภทงาน</label>\r\n                                   <select class=\"form-select\" v-model=\"this.fixCostData.job_type_id\"\r\n                                        @change=\"getProductDetail(this.fixCostData.job_type_id)\">\r\n                                        <option value=\"1\">ค่าจ้าง</option>\r\n                                        <option value=\"2\">ยางพร้อมโครง</option>\r\n                                   </select>\r\n                              </div>\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label>ประเภทการผลิต</label>\r\n                                   <select class=\"form-select\" v-model=\"this.fixCostData.production_type_id\"\r\n                                        @change=\"getProductList(this.fixCostData.production_type_id);\">\r\n                                        <option v-for=\"productDetail in product_detail\"\r\n                                             :key=\"productDetail.production_type_id\"\r\n                                             :value=\"productDetail.production_type_id\">\r\n                                             {{ productDetail.production_type_name }}\r\n                                        </option>\r\n                                   </select>\r\n                              </div>\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label>ข้อมูลสินค้า</label>\r\n                                   <select class=\"form-select\" id=\"productlist1\"\r\n                                        v-model=\"this.fixCostData.product_list_id\">\r\n                                        <option v-for=\"productList in product_list_data\"\r\n                                             :key=\"productList.product_list_id\" :value=\"productList.product_list_id\">\r\n                                             ลายดอก: {{ productList.rub_style_name }} , ขนาดยาง: {{\r\n                                                  productList.rub_size_detail\r\n                                             }}\r\n                                        </option>\r\n                                   </select>\r\n                              </div>\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label>เกรดยาง</label>\r\n                                   <select class=\"form-select\" v-model=\"this.fixCostData.rub_grade_id\">\r\n                                        <option v-for=\"rubberGrade in rubber_grade\" :key=\"rubberGrade.id\"\r\n                                             :value=\"rubberGrade.id\">\r\n                                             {{ rubberGrade.rub_grade_name }}\r\n                                        </option>\r\n                                   </select>\r\n                              </div>\r\n                              <label>ราคาเงินสด</label>\r\n                              <div class=\"input-group mb-2\">\r\n                                   <input type=\"number\" class=\"form-control\" v-model=\"this.fixCostData.price1\" />\r\n                                   <span class=\"input-group-text\">บาท</span>\r\n                              </div>\r\n                              <label>ราคาเงินสด+จัดส่ง</label>\r\n                              <div class=\"input-group mb-2\">\r\n                                   <input type=\"number\" class=\"form-control\" v-model=\"this.fixCostData.price2\" />\r\n                                   <span class=\"input-group-text\">บาท</span>\r\n                              </div>\r\n                         </form>\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                         <button type=\"button\" class=\"btn btn-secondary\"\r\n                              @click.prevent=\"this.func.hideModal('fixCost')\">\r\n                              ปิด\r\n                         </button>\r\n                         <button type=\"button\" class=\"btn btn-primary\" @click.prevent=\"newFixCost()\">\r\n                              บันทึก\r\n                         </button>\r\n                    </div>\r\n                    {{ this.fixCostData }}\r\n               </div>\r\n          </div>\r\n     </div>\r\n     <!-- สิ้นสุดการเพิ่มข้อมูลใหม่ -->\r\n\r\n     <!-- Modal ในส่วนของการแก้ไขข้อมูล -->\r\n     <div class=\"modal fade shadow rounded-3\" id=\"editfixCost\" tabindex=\"-1\">\r\n          <div class=\"modal-dialog\">\r\n               <div class=\"modal-content\">\r\n                    <div class=\"modal-header bg-danger bg-opacity-75\">\r\n                         <h1 class=\"modal-title fs-5\" id=\"exampleModalLabel\" style=\"color: white\">\r\n                              แก้ไขราคาสินค้า > ลำดับที่&nbsp;{{ this.fixCostData_edit.fixcost_id }}\r\n                         </h1>\r\n                         <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n                    </div>\r\n                    <div class=\"modal-body\">\r\n                         <form>\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label for=\"job_type_id\">ประเภทงาน</label>\r\n                                   <select class=\"form-select\" v-model=\"this.fixCostData_edit.job_type_id\"\r\n                                        @change=\"getProductDetail(this.fixCostData_edit.job_type_id)\">\r\n                                        <option value=\"1\">ค่าจ้าง</option>\r\n                                        <option value=\"2\">ยางพร้อมโครง</option>\r\n                                   </select>\r\n                              </div>\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label>ประเภทการผลิต</label>\r\n                                   <select class=\"form-select\" v-model=\"this.fixCostData_edit.production_type_id\"\r\n                                        @change=\"getProductList(this.fixCostData.production_type_id);\">\r\n                                        <option v-for=\"productDetail in product_detail\"\r\n                                             :key=\"productDetail.production_type_id\"\r\n                                             :value=\"productDetail.production_type_id\">\r\n                                             {{ productDetail.production_type_name }}\r\n                                        </option>\r\n                                   </select>\r\n                              </div>\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label>ข้อมูลสินค้า</label>\r\n                                   <select class=\"form-select\" id=\"productlist1\"\r\n                                        v-model=\"this.fixCostData_edit.product_list_id\">\r\n                                        <option v-for=\"productList in product_list_data\"\r\n                                             :key=\"productList.product_list_id\" :value=\"productList.product_list_id\">\r\n                                             ลายดอก: {{ productList.rub_style_name }} , ขนาดยาง: {{\r\n                                                  productList.rub_size_detail\r\n                                             }}\r\n                                        </option>\r\n                                   </select>\r\n                              </div>\r\n                              <div class=\"mb-2 mt-2\">\r\n                                   <label for=\"rub_grade_id\">เกรดยาง</label>\r\n                                   <select class=\"form-select\" v-model=\"this.fixCostData_edit.rub_grade_id\">\r\n                                        <option v-for=\"rubberGrade in rubber_grade\" :key=\"rubberGrade.id\"\r\n                                             :value=\"rubberGrade.id\">\r\n                                             {{ rubberGrade.rub_grade_name }}\r\n                                        </option>\r\n                                   </select>\r\n                              </div>\r\n                              <label>ราคาเงินสด</label>\r\n                              <div class=\"input-group mb-2\">\r\n                                   <input type=\"number\" class=\"form-control\" required\r\n                                        v-model=\"this.fixCostData_edit.price1\" id=\"price1\" />\r\n                                   <span class=\"input-group-text\">บาท</span>\r\n                              </div>\r\n                              <label>ราคาเงินสด+จัดส่ง</label>\r\n                              <div class=\"input-group mb-2\">\r\n                                   <input type=\"number\" class=\"form-control\" required\r\n                                        v-model=\"this.fixCostData_edit.price2\" />\r\n                                   <span class=\"input-group-text\">บาท</span>\r\n                              </div>\r\n                         </form>\r\n                    </div>\r\n                    <div class=\"modal-footer\">\r\n                         <button type=\"button\" class=\"btn btn-secondary\"\r\n                              @click.prevent=\"this.func.hideModal('editfixCost')\">\r\n                              ปิด\r\n                         </button>\r\n                         <button type=\"button\" class=\"btn btn-primary\" @click.prevent=\"editFixCost()\">\r\n                              บันทึก\r\n                         </button>\r\n                         <!-- {{ this.fixCostData_edit }} -->\r\n                    </div>\r\n               </div>\r\n          </div>\r\n     </div>\r\n     <!-- สิ้นสุดการแก้ไขข้อมูล -->\r\n\r\n     <!-- ส่วนของ Datatable แสดงรายการข้อมูล -->\r\n     <div class=\"card shadow-lg\" style=\"width: 100%\">\r\n          <div class=\"card-header bg-primary\" style=\"color: white\">\r\n               ::: แสดงรายการ-ราคาสินค้า :::\r\n          </div>\r\n          <div class=\"card-body\">\r\n               <table id=\"showproductcost\" class=\"table table-striped table-hover table-sm\"\r\n                    style=\"width: 100%; align-items: center\">\r\n                    <thead>\r\n                         <tr>\r\n                              <th>ลำดับ</th>\r\n                              <th>ประเภทงาน</th>\r\n                              <th>ประเภทการผลิต</th>\r\n                              <th>ขนาด</th>\r\n                              <th>ลายดอก</th>\r\n                              <th>เกรดยาง</th>\r\n                              <th>เงินสด</th>\r\n                              <th>เงินสด+ส่ง</th>\r\n                              <th style=\"text-align: left\">\r\n                                   <button class=\"btn btn-success btn-sm me-md-2\"\r\n                                        @click.prevent=\"clearSelect2(); onSelect2_1(); this.func.showModal('fixCost');\">\r\n                                        <!-- ปุ่มเพิ่มข้อมูล -->\r\n                                        <font-awesome-icon icon=\"fa-solid fa-plus\" />\r\n                                   </button>\r\n                              </th>\r\n                         </tr>\r\n                    </thead>\r\n                    <tbody class=\"table-group-divider\">\r\n                         <tr v-for=\"rec in product_cost_data\" :key=\"rec.fixcost_id\" @click.prevent=\"getFixCost(rec)\">\r\n                              <td>{{ product_cost_data.indexOf(rec) + 1 }}</td>\r\n                              <td>{{ rec.job_type_name }}</td>\r\n                              <td>{{ rec.production_type_name }}</td>\r\n                              <td>{{ rec.rub_size_name }} > {{ rec.rub_size_detail }}</td>\r\n                              <td>{{ rec.rub_style_name }}</td>\r\n                              <td>{{ rec.rub_grade_name }}</td>\r\n                              <td>{{ this.numFormat(rec.price1) }}</td>\r\n                              <td>{{ this.numFormat(rec.price2) }}</td>\r\n                              <td style=\"text-align: left\">\r\n                                   <button id=\"edit\" type=\"button\" class=\"btn btn-primary btn-sm me-md-2\"\r\n                                        @click.prevent=\"getFixCost(rec)\">\r\n                                        <!-- ปุ่มแก้ไขข้อมูล -->\r\n                                        <font-awesome-icon icon=\"fa-solid fa-pen\" />\r\n                                   </button>\r\n                              </td>\r\n                         </tr>\r\n                    </tbody>\r\n               </table>\r\n          </div>\r\n     </div>\r\n     <!-- สิ้นสุดการแสดงข้อมูล -->\r\n</template>\r\n\r\n<script>\r\nimport axios from \"@/axios\";\r\nimport $ from \"jquery\";\r\nimport func from \"../func.js\";\r\n\r\nexport default {\r\n     name: \"FixCost\",\r\n     components: {\r\n          // autocomplete\r\n     },\r\n     data() {\r\n          return {\r\n               func: func,\r\n               product_detail: [],\r\n               product_cost_data: [],\r\n               product_list_data: [],\r\n               rubber_grade: [],\r\n               fixCostData: {\r\n                    fixcost_id: \"\",\r\n                    job_type_id: \"\", // link to product_type.job_type_id\r\n                    production_type_id: \"\", // link to product_detail.production_type_id\r\n                    product_list_id: \"\",\r\n                    rub_grade_id: \"\",\r\n                    price1: \"\",\r\n                    price2: \"\",\r\n               },\r\n               fixCostData_edit: {\r\n                    fixcost_id: \"\",\r\n                    job_type_id: \"\", // link to product_type.job_type_id\r\n                    production_type_id: \"\", // link to product_detail.production_type_id\r\n                    product_list_id: \"\",\r\n                    rub_grade_id: \"\",\r\n                    price1: \"\",\r\n                    price2: \"\",\r\n               },\r\n          };\r\n     },\r\n     beforeUnmount() {\r\n          sessionStorage.clear();\r\n     },\r\n     created() { },\r\n     mounted() {\r\n          this.loadDefaultData();\r\n          // this.getRubbergrade();\r\n     },\r\n     methods: {\r\n          clearSelect2() {\r\n               $(document).ready(() => {\r\n                    $(\"#productlist1\").val(\"\");\r\n               });\r\n          },\r\n          onSelect2_1() {\r\n               $(document).ready(() => {                    \r\n                    $(\"#productlist1\").select2({\r\n                         theme: \"bootstrap-5\",\r\n                         closeOnSelect: true,\r\n                         width: \"100%\",\r\n                         dropdownParent: $(\"#productlist1\").parent(),\r\n                         placeholder: \"--- เลือกรายการสินค้า ---\",\r\n                    });\r\n                    $(\"#productlist1\").on(\"select2:select\", (e) => {\r\n                         let data = e.params.data;\r\n                         this.fixCostData.product_list_id = data.id;\r\n                    });\r\n               });\r\n          },\r\n          onSelect2_2() {\r\n               $(document).ready(() => {\r\n                    $(\"#productlist2\").select2({\r\n                         theme: \"bootstrap-5\",\r\n                         closeOnSelect: true,\r\n                         width: \"100%\",\r\n                         dropdownParent: $(\"#productlist2\").parent(),\r\n                         placeholder: \"--- เลือกรายการสินค้า ---\",\r\n                    });\r\n                    $(\"#productlist2\").on(\"select2:select\", (e) => {\r\n                         let data = e.params.data;\r\n                         this.fixCostData_edit.product_list_id = data.id;\r\n                    });\r\n               });\r\n          },\r\n          loadDefaultData() {\r\n               this.getRubbergrade();\r\n               this.getProductCost();\r\n          },\r\n          async newFixCost() {\r\n               if (confirm(\"ยืนยันการบันทึกข้อมูล ?\") == true) {\r\n                    await axios\r\n                         .post(`productcost/new`, this.fixCostData)\r\n                         .then(() => {\r\n                              this.fixCostData = {\r\n                                   fixcost_id: \"\",\r\n                                   job_type_id: \"\", // link to product_type.job_type_id\r\n                                   production_type_id: \"\", // link to product_detail.production_type_id\r\n                                   product_list_id: \"\",\r\n                                   rub_grade_id: \"\",\r\n                                   price1: \"\",\r\n                                   price2: \"\",\r\n                              };\r\n                              func.hideModal(\"fixCost\");\r\n                              $(\"#showproductcost\").DataTable().destroy(); //--- ทำลาย Datatable\r\n                              this.getProductCost();\r\n                              console.log(\"Process success!\");\r\n                         })\r\n                         .catch((error) => {\r\n                              console.log(error);\r\n                         });\r\n               }\r\n          },\r\n          getFixCost(val) {\r\n               this.getProductDetail(val.job_type_id);\r\n               this.getProductList(val.production_type_id);\r\n               this.fixCostData_edit.fixcost_id = val.fixcost_id;\r\n               this.fixCostData_edit.job_type_id = val.job_type_id;\r\n               this.fixCostData_edit.production_type_id = val.production_type_id;\r\n               this.fixCostData_edit.product_list_id = val.product_list_id;\r\n               this.fixCostData_edit.rub_grade_id = val.rub_grade_id;\r\n               this.fixCostData_edit.price1 = val.price1;\r\n               this.fixCostData_edit.price2 = val.price2;\r\n               func.showModal(\"editfixCost\");\r\n               this.onSelect2_2();\r\n          },\r\n          async editFixCost() {\r\n               if (confirm(\"ยืนยันการเปลี่ยนแปลงข้อมูล ?\") == true) {\r\n                    await axios.post(`productcost/update`, this.fixCostData_edit).then(() => {\r\n                         this.fixCostData_edit = {\r\n                              fixcost_id: \"\",\r\n                              job_type_id: \"\", // link to product_type.job_type_id\r\n                              production_type_id: \"\", // link to product_detail.production_type_id\r\n                              product_list_id: \"\",\r\n                              rub_grade_id: \"\",\r\n                              price1: \"\",\r\n                              price2: \"\",\r\n                         };\r\n                         func.hideModal(\"editfixCost\");\r\n                         // $(\"#showproductcost\").DataTable().destroy(); //--- ทำลาย Datatable\r\n                         this.getProductCost();\r\n                    });\r\n               }\r\n          },\r\n          getProductCost() {\r\n               axios.get(`productcost/read`).then((response) => {\r\n                    this.product_cost_data = response.data;\r\n                    // console.log(response.data);\r\n                    $(document).ready(function () {\r\n                         $(\"#showproductcost\").DataTable({\r\n                              scrollY: \"350px\",\r\n                              bJQueryUI: true,\r\n                              sPaginationType: \"full_numbers\",\r\n                              \"destroy\": true,\r\n                              language: {\r\n                                   decimal: \"\",\r\n                                   emptyTable: \"ไม่พบการข้อมูลจากฐานข้อมูล\",\r\n                                   info: \"พบข้อมูล _TOTAL_ เรคอร์ด\",\r\n                                   // \"info\": \"แสดง _START_ - _END_ แถว จากทั้งหมด _TOTAL_ แถว\",\r\n                                   infoEmpty: \"ไม่พบข้อมูลที่ค้นหา\",\r\n                                   infoFiltered: \"(จากข้อมูลทั้งหมด _MAX_ เรคอร์ด)\",\r\n                                   infoPostFix: \"\",\r\n                                   thousands: \",\",\r\n                                   lengthMenu: \"แสดงครั้งละ _MENU_ เรคอร์ด\",\r\n                                   loadingRecords: \"Loading...\",\r\n                                   processing: \"\",\r\n                                   search: \"ค้นหาข้อมูล:\",\r\n                                   zeroRecords: \"ไม่พบข้อมูลที่ค้นหา\",\r\n                                   paginate: {\r\n                                        first: \"หน้าแรก\",\r\n                                        last: \"หน้าสุดท้าย\",\r\n                                        next: \"ต่อไป\",\r\n                                        previous: \"ย้อนกลับ\",\r\n                                   },\r\n                                   aria: {\r\n                                        sortAscending: \": activate to sort column ascending\",\r\n                                        sortDescending: \": activate to sort column descending\",\r\n                                   },\r\n                              },\r\n                         });\r\n                    });\r\n               });\r\n          },\r\n          getProductDetail(val) {\r\n               axios.get(`productdetail/search/${val}`).then((response) => {\r\n                    this.product_detail = response.data;\r\n               });\r\n          },\r\n          getProductList(val) {\r\n               axios.get(`productlist/search_productiontype/${val}`).then((response) => {\r\n                    this.product_list_data = response.data;\r\n               });\r\n          },\r\n          getRubbergrade() {\r\n               axios.get(`rubbergrade/read`).then((response) => {\r\n                    this.rubber_grade = response.data;\r\n               });\r\n          },\r\n          numFormat(e) {\r\n               const nf = new Intl.NumberFormat(\"th-TH\", {\r\n                    style: \"currency\",\r\n                    currency: \"THB\",\r\n                    maximumFractionDigits: 2,\r\n               }).format(e);\r\n               return nf;\r\n          },\r\n     },\r\n};\r\n</script>\r\n\r\n<style>\r\n.select2-selection {\r\n     /* height: 58px !important; */\r\n     border-color: #ced4da !important;\r\n}\r\n\r\nlabel {\r\n     color: gray;\r\n     font-style: italic;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}