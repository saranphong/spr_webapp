{"ast":null,"code":"import $ from \"jquery\";\nimport axios from \"@/axios\";\nimport { Modal } from \"bootstrap\";\nimport { ref } from \"vue\";\nexport default {\n  setup() {\n    const date = ref(new Date());\n\n    const format = date => {\n      const d = date.getDate();\n      const m = date.getMonth() + 1;\n      const y = date.getFullYear();\n      return `${d}/${m}/${y}`;\n    };\n\n    return {\n      date,\n      format\n    };\n  },\n\n  components: {},\n\n  data() {\n    return {\n      cust_name: \"\",\n      cust_addr: \"\",\n      cust_tel: \"\",\n      check_bill_header: [],\n      customer_data: [],\n      rubber_size: [],\n      rubber_brand: [],\n      import_header: {\n        import_id: \"\",\n        import_book_id: \"\",\n        import_book_no: \"\",\n        import_user: \"\",\n        cust_auto_id: \"\",\n        import_type_id: \"\",\n        import_date: \"\",\n        import_status: \"\"\n      },\n      import_detail: {\n        import_id: \"\",\n        rub_size_id: \"\",\n        rub_brand_id: \"\",\n        manufac_id: \"\",\n        import_detail_status: \"\"\n      }\n    };\n  },\n\n  mounted() {\n    let import_book_id = sessionStorage.getItem(\"import_book_id\");\n    let import_book_no = sessionStorage.getItem(\"import_book_no\");\n\n    if (import_book_id != null && import_book_no != null) {\n      this.chkImportHeader(import_book_id, import_book_no);\n    } else {\n      let import_id = sessionStorage.getItem(\"import_id\");\n      this.import_detail.import_id = import_id;\n      this.chkImportHeaderById(import_id);\n    }\n  },\n\n  beforeUnmount() {\n    sessionStorage.clear();\n  },\n\n  methods: {\n    showDatePicker() {\n      let data = this.import_header;\n      $(document).ready(() => {\n        $('#datepicker').datepicker({\n          format: \"dd/mm/yyyy\",\n          autoclose: true,\n          toggleActive: true\n        });\n        $('#datepicker').change(() => {\n          data.import_date = $('#datepicker').val();\n        });\n      });\n    },\n\n    convertDateToMySql(isdate) {\n      const convertdate = isdate.split(\"/\");\n      let dateToMySql = convertdate[2] + \"-\" + convertdate[1] + \"-\" + convertdate[0];\n      return dateToMySql;\n    },\n\n    onSelect2_Size() {\n      $(document).ready(() => {\n        let rec = this.import_detail;\n        $('#findSize').select2({\n          theme: \"bootstrap-5\",\n          closeOnSelect: true,\n          width: '100%',\n          dropdownParent: $(\"#findSize\").parent(),\n          placeholder: \"--- เลือกขนาดยาง ---\"\n        });\n        $('#findSize').on('select2:select', e => {\n          let data = e.params.data;\n          rec.rub_size_no = data.id;\n        });\n      });\n    },\n\n    clearSelect2() {\n      $(document).ready(() => {\n        $('#findSize').val(\"\");\n      });\n    },\n\n    getUseData() {\n      this.getRubberSize();\n      this.getRubberBrand();\n    },\n\n    async chkImportHeader(val1, val2) {\n      await axios.get(`billimport/search/${val1}/${val2}`).then(response => {\n        // this.check_bill_header = response.data;\n        this.import_header.import_id = response.data[0].import_id;\n        this.import_header.import_book_id = response.data[0].import_book_id;\n        this.import_header.import_book_no = response.data[0].import_book_no;\n        this.import_header.import_user = response.data[0].import_user;\n        this.import_header.cust_auto_id = response.data[0].cust_auto_id;\n        this.import_header.import_type_id = response.data[0].import_type_id;\n        this.import_header.import_date = response.data[0].new_import_date;\n        this.import_header.import_status = response.data[0].import_status;\n      });\n    },\n\n    async chkImportHeaderById(val) {\n      await axios.get(`billimport/searchid/${val}`).then(response => {\n        // this.check_bill_header = response.data;\n        this.import_header.import_id = response.data[0].import_id;\n        this.import_header.import_book_id = response.data[0].import_book_id;\n        this.import_header.import_book_no = response.data[0].import_book_no;\n        this.import_header.import_user = response.data[0].import_user;\n        this.import_header.cust_auto_id = response.data[0].cust_auto_id;\n        this.import_header.import_type_id = response.data[0].import_type_id;\n        this.import_header.import_date = response.data[0].new_import_date;\n        this.dd = this.import_header.import_date.substring(0, 2);\n        this.mm = this.import_header.import_date.substring(3, 5);\n        this.yy = this.import_header.import_date.substring(6, 10);\n        this.import_header.import_status = response.data[0].import_status;\n        this.cust_name = response.data[0].customerName;\n        this.cust_addr = response.data[0].customerAddr;\n        this.cust_tel = response.data[0].customerTel;\n      });\n    },\n\n    newImportDetail() {\n      if (this.import_header.import_book_id == null || this.import_header.import_book_no == null || this.import_header.import_date == null) {\n        alert('ข้อมูลหลักไม่ครบถ้วน.,กรุณาตรวจสอบ !!!'); // document.getElementById(\"book_id\").value = 'xxx';\n\n        document.getElementById(\"book_id\").focus();\n        document.getElementById(\"book_id\").select(); //document.getElementById(\"book_no\").disabled = true;             \n      } else {\n        this.onSelect2_Size();\n        this.getUseData();\n        this.showModal('newImportDetail');\n      }\n    },\n\n    saveImportDetail() {\n      if (confirm(\"ยืนยันการบันทึกรายการ\") == true) {\n        axios.post(`billimport/detail/new`, this.import_detail).then(() => {\n          this.import_detail = {\n            import_id: \"\",\n            rub_size_id: \"\",\n            rub_brand_id: \"\",\n            manufac_id: \"\",\n            import_detail_status: \"\"\n          };\n        }).catch(error => {\n          console.log(error);\n        });\n      }\n    },\n\n    getCustomer(val) {\n      axios.get(`customer/findbyautoid/${val}`).then(response => {\n        // this.customer_data = response.data;\n        // console.log(response.data[0].cust_auto_id);\n        this.import_header = {\n          cust_auto_id: response.data[0].cust_auto_id\n        };\n\n        if (response.data[0].cust_auto_id == 1) {\n          this.import_header.import_type_id = 2;\n        } else this.import_header.import_type_id = 1;\n\n        this.cust_name = response.data[0].customerName;\n        this.cust_addr = response.data[0].customerAddr;\n        this.cust_tel = response.data[0].customerTel;\n      });\n    },\n\n    getRubberSize() {\n      axios.get(`rubbersize/read`).then(response => {\n        this.rubber_size = response.data;\n      });\n    },\n\n    getRubberBrand() {\n      axios.get(`rubberbrand/read`).then(response => {\n        this.rubber_brand = response.data;\n      });\n    },\n\n    async showModal(e) {\n      let myModal = await new Modal(document.getElementById(e));\n      await myModal.show();\n    },\n\n    async hideModal(e) {\n      await $(`#${e}`).removeClass(\"in\");\n      await $(\".modal-backdrop\").remove();\n      await $(`#${e}`).hide();\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["$","axios","Modal","ref","setup","date","Date","format","d","getDate","m","getMonth","y","getFullYear","components","data","cust_name","cust_addr","cust_tel","check_bill_header","customer_data","rubber_size","rubber_brand","import_header","import_id","import_book_id","import_book_no","import_user","cust_auto_id","import_type_id","import_date","import_status","import_detail","rub_size_id","rub_brand_id","manufac_id","import_detail_status","mounted","sessionStorage","getItem","chkImportHeader","chkImportHeaderById","beforeUnmount","clear","methods","showDatePicker","document","ready","datepicker","autoclose","toggleActive","change","val","convertDateToMySql","isdate","convertdate","split","dateToMySql","onSelect2_Size","rec","select2","theme","closeOnSelect","width","dropdownParent","parent","placeholder","on","e","params","rub_size_no","id","clearSelect2","getUseData","getRubberSize","getRubberBrand","val1","val2","get","then","response","new_import_date","dd","substring","mm","yy","customerName","customerAddr","customerTel","newImportDetail","alert","getElementById","focus","select","showModal","saveImportDetail","confirm","post","catch","error","console","log","getCustomer","myModal","show","hideModal","removeClass","remove","hide"],"sourceRoot":"","sources":["D:\\Project-vue\\SPR-PROJECT\\main-app-test\\src\\components\\importWork.vue"],"sourcesContent":["// ทำใบรับยางสำหรับการจ้างอัด\r\n<template>\r\n    <!-- Modal เพิ่มรายละเอียดใบรับ -->\r\n    <div class=\"modal fade rounded-3\" id=\"newImportDetail\" tabindex=\"-1\">\r\n        <div class=\"modal-dialog modal-xl\" role=\"document\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header bg-primary opacity-75\" style=\"color:white ;font-size:20px ;\">\r\n                    รายละเอียดใบรับ\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-4\" style=\"text-align:left;\">\r\n                            <label>ขนาดยาง</label>\r\n                            <select class=\"form-select\" id=\"findSize\" v-model=\"this.import_detail.rub_size_id\">\r\n                                <option v-for=\"rubberSize in rubber_size\" :key=\"rubberSize.id\" :value=\"rubberSize.id\">\r\n                                    {{ rubberSize.rub_size_id }} > {{ rubberSize.rub_size_detail }}\r\n                                </option>\r\n                            </select>\r\n                        </div>\r\n                        <div class=\"col-3\" style=\"text-align:left;\">\r\n                            <label>ยี่ห้อยาง</label>\r\n                            <select class=\"form-select\" id=\"findBrand\" v-model=\"this.import_detail.rub_brand_id\">\r\n                                <option v-for=\"rubberBrand in rubber_brand\" :key=\"rubberBrand.rub_brand_id\"\r\n                                    :value=\"rubberBrand.rub_brand_id\">\r\n                                    {{ rubberBrand.rub_brand_shotname }} > {{ rubberBrand.rub_brand_name }}\r\n                                </option>\r\n                            </select>\r\n                        </div>\r\n                        <div class=\"col-2\" style=\"text-align:left;\">\r\n                            <label>หมายเลขยาง(จากโครง)</label>\r\n                            <input type=\"text\" class=\"form-control\" v-model=\"this.import_detail.manufac_id\" />\r\n                        </div>\r\n                        <div class=\"col-3\" style=\"text-align:left;\">\r\n                            <label>หมายเหตุ</label>\r\n                            <input type=\"text\" class=\"form-control\" v-model=\"this.import_detail.import_detail_status\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <!-- ปุ่มปิด -->\r\n                    <button type=\"button\" class=\"btn btn-secondary\"\r\n                        @click.prevent=\"clearSelect2(); hideModal('newImportDetail')\">\r\n                        <font-awesome-icon icon=\"fa-solid fa-ban\" />&nbsp;ปิดหน้าต่าง\r\n                    </button>\r\n                    <!-- ปุ่มบันทึก -->\r\n                    <button id=\"btn\" class=\"btn btn-primary\" @click.prevent=\"saveImportDetail();\">\r\n                        <font-awesome-icon icon=\"fa-solid fa-circle-check\" />&nbsp;บันทึก\r\n                    </button>                    \r\n                </div>\r\n                {{ this.import_detail }}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <!-- End modal -->\r\n    <div id=\"test\">\r\n        <div class=\"container\" style=\"text-align:center;\">\r\n            <div class=\"card align-content-center rounded-3 shadow\" style=\"max-width:auto;\">\r\n                <div class=\"card-header bg-primary\" style=\"color:white; text-align:center; font-size: 20px;\">\r\n                    ใบรับ (\r\n                    <select class=\"rounded-2 bg-primary border-0\" style=\"color:yellow ;\"\r\n                        v-model=\"this.import_header.import_type_id\" disabled>\r\n                        <option value=\"1\">ค่าจ้าง</option>\r\n                        <option value=\"2\">พร้อมโครง</option>\r\n                    </select> )\r\n                    <button class=\"btn btn-success rounded-2 me-2\">\r\n                        <font-awesome-icon icon=\"fa-solid fa-check-to-slot\" />&nbsp;ยืนยันใบรับ\r\n                    </button>\r\n                </div>\r\n                <div class=\"card-body\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col\" style=\"text-align:left;\">\r\n                            <label>เล่มที่</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"book_id\"\r\n                                v-model=\"this.import_header.import_book_id\" readonly />\r\n                        </div>\r\n                        <div class=\"col\" style=\"text-align:left;\">\r\n                            <label>เลขที่</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"book_no\"\r\n                                v-model=\"this.import_header.import_book_no\" readonly />\r\n                        </div>\r\n                        <div class=\"col\" style=\"text-align:left;\">\r\n                            <label>วันที่เปิดใบรับ(DD/MM/YYYY)</label>\r\n                            <input type=\"text\" class=\"date form-control\" id=\"datepicker\"\r\n                                v-model=\"this.import_header.import_date\" @click.prevent=\"showDatePicker();\" readonly />\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row mt-1\">\r\n                        <div class=\"col\" style=\"text-align:left;\">\r\n                            <label>ชื่อลูกค้า</label>\r\n                            <input type=\"text\" class=\"form-control\" v-model=\"this.cust_name\" readonly />\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row mt-1\">\r\n                        <div class=\"col-8\" style=\"text-align:left;\">\r\n                            <label>ที่อยู่ลูกค้า</label>\r\n                            <input type=\"text\" class=\"form-control\" v-model=\"this.cust_addr\" readonly />\r\n                        </div>\r\n                        <div class=\"col-4\" style=\"text-align:left;\">\r\n                            <label>เบอร์โทร</label>\r\n                            <input type=\"text\" class=\"form-control\" v-model=\"this.cust_tel\" readonly />\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row-12 mt-2 align-content-center\">\r\n                        <button class=\"btn btn-warning rounded-2 me-2\">\r\n                            <font-awesome-icon icon=\"fa-solid fa-pen\" />&nbsp;แก้ไขใบรับ\r\n                        </button>\r\n                        <button class=\"btn btn-danger rounded-2 me-2\">\r\n                            <font-awesome-icon icon=\"fa-solid fa-file-circle-xmark\" />&nbsp;ยกเลิกใบรับ\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"card-footer align-content-center\" id=\"control-detail\">\r\n                    <button class=\"btn btn-primary rounded-2 me-2\" @click.prevent=\"newImportDetail()\">\r\n                        <font-awesome-icon icon=\"fa-solid fa-cart-plus\" />&nbsp;เพิ่มรายการรับ\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- {{ this.import_header }} -->\r\n        <div class=\"container\">\r\n            <div class=\"card align-content-center rounded-3 shadow mt-2\" style=\"max-width:auto;\">\r\n                <div class=\"card-header bg-primary\" style=\"color:white ;text-align:center\">รายละเอียดใบรับ</div>\r\n                <div class=\"card-body\">\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport $ from \"jquery\"\r\nimport axios from \"@/axios\"\r\nimport { Modal } from \"bootstrap\"\r\nimport { ref } from \"vue\"\r\n\r\nexport default {\r\n    setup() {\r\n        const date = ref(new Date());\r\n        const format = (date) => {\r\n            const d = date.getDate();\r\n            const m = date.getMonth() + 1;\r\n            const y = date.getFullYear();\r\n            return `${d}/${m}/${y}`;\r\n        }\r\n        return {\r\n            date, format\r\n        }\r\n    },\r\n    components: {\r\n\r\n    },\r\n    data() {\r\n        return {\r\n            cust_name: \"\",\r\n            cust_addr: \"\",\r\n            cust_tel: \"\",\r\n            check_bill_header: [],\r\n            customer_data: [],\r\n            rubber_size: [],\r\n            rubber_brand: [],\r\n            import_header: {\r\n                import_id: \"\",\r\n                import_book_id: \"\",\r\n                import_book_no: \"\",\r\n                import_user: \"\",\r\n                cust_auto_id: \"\",\r\n                import_type_id: \"\",\r\n                import_date: \"\",\r\n                import_status: \"\",\r\n            },\r\n            import_detail: {\r\n                import_id: \"\",\r\n                rub_size_id: \"\",\r\n                rub_brand_id: \"\",\r\n                manufac_id: \"\",\r\n                import_detail_status: \"\",\r\n            },\r\n        }\r\n    },\r\n    mounted() {\r\n        let import_book_id = sessionStorage.getItem(\"import_book_id\");\r\n        let import_book_no = sessionStorage.getItem(\"import_book_no\");\r\n        if (import_book_id != null && import_book_no != null) {\r\n            this.chkImportHeader(import_book_id, import_book_no);\r\n        } else {\r\n            let import_id = sessionStorage.getItem(\"import_id\");\r\n            this.import_detail.import_id = import_id;\r\n            this.chkImportHeaderById(import_id);\r\n        }\r\n    },\r\n    beforeUnmount() {\r\n        sessionStorage.clear();\r\n    },\r\n    methods: {\r\n        showDatePicker() {\r\n            let data = this.import_header;\r\n            $(document).ready(() => {\r\n                $('#datepicker').datepicker({\r\n                    format: \"dd/mm/yyyy\",\r\n                    autoclose: true,\r\n                    toggleActive: true,\r\n                });\r\n                $('#datepicker').change(() => {\r\n                    data.import_date = $('#datepicker').val();\r\n                })\r\n            });\r\n        },\r\n        convertDateToMySql(isdate) {\r\n            const convertdate = isdate.split(\"/\");\r\n            let dateToMySql = convertdate[2] + \"-\" + convertdate[1] + \"-\" + convertdate[0];\r\n            return dateToMySql;\r\n        },\r\n        onSelect2_Size() {\r\n            $(document).ready(() => {\r\n                let rec = this.import_detail;\r\n                $('#findSize').select2({\r\n                    theme: \"bootstrap-5\",\r\n                    closeOnSelect: true,\r\n                    width: '100%',\r\n                    dropdownParent: $(\"#findSize\").parent(),\r\n                    placeholder: \"--- เลือกขนาดยาง ---\",\r\n                });\r\n                $('#findSize').on('select2:select', (e) => {\r\n                    let data = e.params.data;\r\n                    rec.rub_size_no = data.id;\r\n                })\r\n            });\r\n        },\r\n        clearSelect2() {\r\n            $(document).ready(() => {\r\n                $('#findSize').val(\"\");\r\n            })\r\n        },\r\n        getUseData() {\r\n            this.getRubberSize();\r\n            this.getRubberBrand();\r\n        },\r\n        async chkImportHeader(val1, val2) {\r\n            await axios.get(`billimport/search/${val1}/${val2}`).then((response) => {\r\n                // this.check_bill_header = response.data;\r\n                this.import_header.import_id = response.data[0].import_id;\r\n                this.import_header.import_book_id = response.data[0].import_book_id;\r\n                this.import_header.import_book_no = response.data[0].import_book_no;\r\n                this.import_header.import_user = response.data[0].import_user;\r\n                this.import_header.cust_auto_id = response.data[0].cust_auto_id;\r\n                this.import_header.import_type_id = response.data[0].import_type_id;\r\n                this.import_header.import_date = response.data[0].new_import_date;\r\n                this.import_header.import_status = response.data[0].import_status;\r\n            });\r\n        },\r\n        async chkImportHeaderById(val) {\r\n            await axios.get(`billimport/searchid/${val}`).then((response) => {\r\n                // this.check_bill_header = response.data;\r\n                this.import_header.import_id = response.data[0].import_id;\r\n                this.import_header.import_book_id = response.data[0].import_book_id;\r\n                this.import_header.import_book_no = response.data[0].import_book_no;\r\n                this.import_header.import_user = response.data[0].import_user;\r\n                this.import_header.cust_auto_id = response.data[0].cust_auto_id;\r\n                this.import_header.import_type_id = response.data[0].import_type_id;\r\n                this.import_header.import_date = response.data[0].new_import_date;\r\n                this.dd = this.import_header.import_date.substring(0, 2);\r\n                this.mm = this.import_header.import_date.substring(3, 5);\r\n                this.yy = this.import_header.import_date.substring(6, 10);\r\n                this.import_header.import_status = response.data[0].import_status;\r\n                this.cust_name = response.data[0].customerName;\r\n                this.cust_addr = response.data[0].customerAddr;\r\n                this.cust_tel = response.data[0].customerTel;\r\n            });\r\n        },\r\n        newImportDetail() {\r\n            if ((this.import_header.import_book_id == null) ||\r\n                (this.import_header.import_book_no == null) ||\r\n                (this.import_header.import_date == null)) {\r\n                alert('ข้อมูลหลักไม่ครบถ้วน.,กรุณาตรวจสอบ !!!')\r\n                // document.getElementById(\"book_id\").value = 'xxx';\r\n                document.getElementById(\"book_id\").focus();\r\n                document.getElementById(\"book_id\").select();\r\n                //document.getElementById(\"book_no\").disabled = true;             \r\n            } else {\r\n                this.onSelect2_Size();\r\n                this.getUseData();\r\n                this.showModal('newImportDetail');\r\n            }\r\n        },\r\n        saveImportDetail() {\r\n            if (confirm(\"ยืนยันการบันทึกรายการ\") == true) {\r\n                axios.post(`billimport/detail/new`, this.import_detail).then(() => {\r\n                    this.import_detail = {\r\n                        import_id: \"\",\r\n                        rub_size_id: \"\",\r\n                        rub_brand_id: \"\",\r\n                        manufac_id: \"\",\r\n                        import_detail_status: \"\"\r\n                    };\r\n                }).catch((error) => {\r\n                    console.log(error);\r\n                });\r\n            }\r\n        },\r\n        getCustomer(val) {\r\n            axios.get(`customer/findbyautoid/${val}`).then((response) => {\r\n                // this.customer_data = response.data;\r\n                // console.log(response.data[0].cust_auto_id);\r\n                this.import_header = {\r\n                    cust_auto_id: response.data[0].cust_auto_id\r\n                }\r\n                if (response.data[0].cust_auto_id == 1) { this.import_header.import_type_id = 2 }\r\n                else this.import_header.import_type_id = 1\r\n\r\n                this.cust_name = response.data[0].customerName\r\n                this.cust_addr = response.data[0].customerAddr\r\n                this.cust_tel = response.data[0].customerTel\r\n            });\r\n        },\r\n        getRubberSize() {\r\n            axios.get(`rubbersize/read`).then((response) => {\r\n                this.rubber_size = response.data;\r\n            });\r\n        },\r\n        getRubberBrand() {\r\n            axios.get(`rubberbrand/read`).then((response) => {\r\n                this.rubber_brand = response.data;\r\n            });\r\n        },\r\n        async showModal(e) {\r\n            let myModal = await new Modal(document.getElementById(e))\r\n            await myModal.show()\r\n        },\r\n        async hideModal(e) {\r\n            await $(`#${e}`).removeClass(\"in\");\r\n            await $(\".modal-backdrop\").remove();\r\n            await $(`#${e}`).hide();\r\n        },\r\n    },\r\n}\r\n</script>"]},"metadata":{},"sourceType":"module"}