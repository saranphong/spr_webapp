{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"@/axios\";\nimport $ from \"jquery\";\nimport { Modal } from \"bootstrap\";\nimport { ref } from \"vue\";\nexport default {\n  setup() {\n    const date = ref(new Date());\n\n    const format = date => {\n      const d = date.getDate();\n      const m = date.getMonth() + 1;\n      const y = date.getFullYear();\n      return `${d}/${m}/${y}`;\n    };\n\n    return {\n      date,\n      format\n    };\n  },\n\n  data() {\n    return {\n      isLoading: false,\n      data_row: [],\n      province_id: [],\n      check_bill_header: \"\",\n      newRec: {\n        customerId: \"\",\n        customerName: \"\",\n        customerAddr: \"\",\n        province_id: \"\",\n        postCode: \"\",\n        customerTel: \"\",\n        contactName: \"\",\n        contactTel: \"\",\n        contactPosition: \"\",\n        payType: \"\",\n        creditDay: \"\",\n        creditLimit: \"\",\n        priceType: \"\",\n        remark: \"\",\n        customerDel: \"\"\n      },\n      editCustomer: {\n        customerId: \"\",\n        customerName: \"\",\n        customerAddr: \"\",\n        province_id: \"\",\n        postCode: \"\",\n        customerTel: \"\",\n        contactName: \"\",\n        contactTel: \"\",\n        contactPosition: \"\",\n        payType: \"\",\n        creditDay: \"\",\n        creditLimit: \"\",\n        priceType: \"\",\n        remark: \"\",\n        customerDel: \"\"\n      },\n      // temp\n      tmp_cust_name: \"\",\n      tmp_cust_addr: \"\",\n      tmp_cust_tel: \"\",\n      import_header: {\n        import_book_id: \"\",\n        import_book_no: \"\",\n        cust_auto_id: \"\",\n        import_user: 1,\n        import_type_id: \"\",\n        import_date: \"\",\n        import_status: \"รอดำเนินการ\"\n      }\n    };\n  },\n\n  created() {\n    this.getData();\n  },\n\n  methods: {\n    onSelect2() {\n      $(document).ready(() => {\n        let rec = this.editCustomer;\n        $(\"#findSelect\").select2({\n          theme: \"bootstrap-5\",\n          closeOnSelect: true,\n          width: \"100%\",\n          dropdownParent: $(\"#findSelect\").parent(),\n          placeholder: \"--- เลือกจังหวัด ---\" // tags: true,\n\n        });\n        $(\"#findSelect\").on(\"select2:select\", function (e) {\n          let data = e.params.data;\n          rec.province_id = data.id;\n        });\n      });\n    },\n\n    showDatePicker() {\n      let data = this.import_header;\n      $(document).ready(() => {\n        $('#datepicker').datepicker({\n          format: \"dd/mm/yyyy\",\n          autoclose: true,\n          templates: \"bootstrap-5\",\n          toggleActive: true\n        });\n        $('#datepicker').change(() => {\n          data.import_date = $('#datepicker').val();\n        });\n      });\n    },\n\n    goLoading() {\n      this.isLoading = true;\n      setTimeout(() => {\n        this.isLoading = false;\n      }, 5000);\n    },\n\n    inputFocus(Modal, InputModal) {\n      const myModal = document.getElementById(Modal);\n      const myInput = document.getElementById(InputModal);\n      myModal.addEventListener(\"shown.bs.modal\", () => {\n        myInput.focus();\n      });\n    },\n\n    newCustomer() {\n      this.$router.push(\"/newcustomer\");\n    },\n\n    async editCustomer_Modal(val) {\n      this.editCustomer.customerId = await val.customerId;\n      this.editCustomer.customerName = await val.customerName;\n      this.editCustomer.customerAddr = await val.customerAddr;\n      this.editCustomer.province_id = await val.province_id;\n      this.editCustomer.postCode = await val.postCode;\n      this.editCustomer.customerTel = await val.customerTel;\n      this.editCustomer.contactName = await val.contactName;\n      this.editCustomer.contactTel = await val.contactTel;\n      this.editCustomer.contactPosition = await val.contactPosition;\n      this.editCustomer.payType = await val.payType;\n      this.editCustomer.creditDay = await val.creditDay;\n      this.editCustomer.creditLimit = await val.creditLimit;\n      this.editCustomer.priceType = await val.priceType;\n      this.editCustomer.remark = await val.remark;\n      this.editCustomer.customerDel = await val.customerDel;\n      await this.showModal(\"editCustModal\");\n      await this.onSelect2(); //this.inputFocus(\"editCustModal\", \"input_name\");\n    },\n\n    async saveNewrec() {\n      // await axios.post(`${apiURL}/customer/new`, this.newRec).then(() => {\n      await axios.post(`customer/new`, this.newRec).then(() => {\n        this.newRec = {\n          customerId: \"\",\n          customerName: \"\",\n          customerAddr: \"\",\n          province_id: \"\",\n          postCode: \"\",\n          customerTel: \"\",\n          contactName: \"\",\n          contactTel: \"\",\n          contactPosition: \"\",\n          payType: \"\",\n          creditDay: \"\",\n          creditLimit: \"\",\n          priceType: \"\",\n          remark: \"\",\n          customerDel: \"\"\n        };\n        this.$router.push(\"/showcustomer\");\n        console.log(\"Process success!\");\n      }).catch(error => {\n        console.log(error);\n      });\n      this.$router.push(\"/\");\n    },\n\n    async saveEditCustomer() {\n      //let editModal = document.getElementById('editCustModal')\n      if (confirm(\"ยืนยันการเปลี่ยนแปลงข้อมูล ?\") == true) {\n        await axios.post(`customer/update`, this.editCustomer).then(() => {\n          this.editCustomer = {\n            customerId: \"\",\n            customerName: \"\",\n            customerAddr: \"\",\n            province_id: \"\",\n            postCode: \"\",\n            customerTel: \"\",\n            contactName: \"\",\n            contactTel: \"\",\n            contactPosition: \"\",\n            payType: \"\",\n            creditDay: \"\",\n            creditLimit: \"\",\n            priceType: \"\",\n            remark: \"\",\n            customerDel: \"\"\n          };\n          this.hideModal(\"editCustModal\"); // ---------------------------------\n\n          $(\"#showcustomer\").DataTable().destroy(); //--- ทำลาย Datatable\n\n          this.getData();\n          console.log(\"Process success!\");\n        }).catch(error => {\n          console.log(error);\n        });\n      }\n    },\n\n    async getData() {\n      this.goLoading();\n      await axios.get(`customer/read`).then(response => {\n        this.data_row = response.data;\n        $(document).ready(function () {\n          $(\"#showcustomer\").DataTable({\n            // \"fnRowCallback\": function (nRow, aData,) { // เช็คเงื่อนไขในแต่ละเรคคอร์ด\n            //      if (aData[3] == \"handsome\") {\n            //           $('td', nRow).css('color', 'Red');\n            //      }\n            // }\n            //\"dom\": 'Bfrtip',\n            //\"buttons\": ['excel', 'pdf'],\n            scrollY: \"300px\",\n            // \"scrollX\": false,\n            // scrollCollapse: true,\n            // paging: false,\n            // rowReorder: true,\n            // \"bJQueryUI\": true,\n            autoFill: true,\n            sPaginationType: \"full_numbers\",\n            language: {\n              decimal: \"\",\n              emptyTable: \"ไม่พบการข้อมูลจากฐานข้อมูล\",\n              info: \"พบข้อมูล _TOTAL_ เรคอร์ด\",\n              // \"info\": \"แสดง _START_ - _END_ แถว จากทั้งหมด _TOTAL_ แถว\",\n              infoEmpty: \"ไม่พบข้อมูลที่ค้นหา\",\n              infoFiltered: \"(จากข้อมูลทั้งหมด _MAX_ เรคอร์ด)\",\n              infoPostFix: \"\",\n              thousands: \",\",\n              lengthMenu: \"แสดงครั้งละ _MENU_ เรคอร์ด\",\n              loadingRecords: \"Loading...\",\n              processing: \"\",\n              search: \"ค้นหาข้อมูล:\",\n              zeroRecords: \"ไม่พบข้อมูลที่ค้นหา\",\n              paginate: {\n                first: \"หน้าแรก\",\n                last: \"หน้าสุดท้าย\",\n                next: \"ต่อไป\",\n                previous: \"ย้อนกลับ\"\n              },\n              aria: {\n                sortAscending: \": activate to sort column ascending\",\n                sortDescending: \": activate to sort column descending\"\n              }\n            }\n          });\n        });\n      });\n      await axios.get(`province/read`).then(response => {\n        this.province_id = response.data;\n      });\n    },\n\n    setCreditday() {\n      if (this.editCustomer.payType == 1) {\n        this.editCustomer.creditDay = 0;\n        this.editCustomer.creditLimit = 0;\n        this.editCustomer.priceType = 1;\n      } else {\n        this.editCustomer.creditDay = 30;\n        this.editCustomer.creditLimit = 0;\n        this.editCustomer.priceType = 3;\n      }\n    },\n\n    importBill(val) {\n      // sessionStorage.setItem(\"cust_id\", val.cust_auto_id);\n      // this.$router.push(\"/importWork\");\n      let imp_type;\n\n      if (val.cust_auto_id == 1) {\n        imp_type = 2;\n      } else {\n        imp_type = 1;\n      }\n\n      this.tmp_cust_name = val.customerName;\n      this.tmp_cust_addr = val.customerAddr;\n      this.tmp_cust_tel = val.customerTel;\n      this.import_header.cust_auto_id = val.cust_auto_id;\n      this.import_header.import_type_id = imp_type;\n      this.showModal(\"importHeader\");\n    },\n\n    async saveImportBill() {\n      if (this.import_header.import_book_id == \"\" || this.import_header.import_book_no == \"\" || this.import_header.import_date == \"\") {\n        alert(\"กรุณากรอกข้อมูลให้ครบถ้วน(เล่มที่, เลขที่ หรือ วันที่) !!!\");\n        document.getElementById(\"book_id\").focus();\n        document.getElementById(\"book_id\").select();\n      } else {\n        await this.chkImportHeader(this.import_header.import_book_id, this.import_header.import_book_no);\n\n        if ((await this.check_bill_header) == 0) {\n          if ((await confirm(\"ยืนยันการสร้างใบรับ\")) == true) {\n            await sessionStorage.setItem('import_book_id', this.import_header.import_book_id);\n            await sessionStorage.setItem('import_book_no', this.import_header.import_book_no);\n            await axios.post(`billimport/new`, this.import_header).then(() => {\n              this.import_header = {\n                import_book_id: \"\",\n                import_book_no: \"\",\n                cust_auto_id: \"\",\n                import_user: \"\",\n                import_type_id: \"\",\n                import_date: new Date(),\n                import_status: \"รอดำเนินการ\"\n              };\n            }).catch(error => {\n              console.log(error);\n            });\n\n            if ((await confirm(\"บันทึกข้อมูลสำเร็จ...ต้องการเพิ่มรายการในบิลเลยหรือไม่?\")) == true) {\n              this.hideModal(\"importHeader\");\n              this.$router.push(\"/importWork\");\n            } else {\n              await sessionStorage.removeItem('import_book_id');\n              await sessionStorage.removeItem('import_book_no');\n              await this.hideModal(\"importHeader\");\n            }\n          }\n        } else alert(\"ไม่สามารถใช้หมายเลขเล่ม และเลขบิลนี้ได้ กรุณาตรวจสอบ !!!\");\n      }\n    },\n\n    async chkImportHeader(val1, val2) {\n      await axios.get(`billimport/search/${val1}/${val2}`).then(response => {\n        this.check_bill_header = response.data.length;\n      });\n    },\n\n    async showModal(e) {\n      let myModal = await new Modal(document.getElementById(e));\n      await myModal.show();\n    },\n\n    async hideModal(e) {\n      await $(`#${e}`).removeClass(\"in\");\n      await $(\".modal-backdrop\").remove();\n      await $(`#${e}`).hide();\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","$","Modal","ref","setup","date","Date","format","d","getDate","m","getMonth","y","getFullYear","data","isLoading","data_row","province_id","check_bill_header","newRec","customerId","customerName","customerAddr","postCode","customerTel","contactName","contactTel","contactPosition","payType","creditDay","creditLimit","priceType","remark","customerDel","editCustomer","tmp_cust_name","tmp_cust_addr","tmp_cust_tel","import_header","import_book_id","import_book_no","cust_auto_id","import_user","import_type_id","import_date","import_status","created","getData","methods","onSelect2","document","ready","rec","select2","theme","closeOnSelect","width","dropdownParent","parent","placeholder","on","e","params","id","showDatePicker","datepicker","autoclose","templates","toggleActive","change","val","goLoading","setTimeout","inputFocus","InputModal","myModal","getElementById","myInput","addEventListener","focus","newCustomer","$router","push","editCustomer_Modal","showModal","saveNewrec","post","then","console","log","catch","error","saveEditCustomer","confirm","hideModal","DataTable","destroy","get","response","scrollY","autoFill","sPaginationType","language","decimal","emptyTable","info","infoEmpty","infoFiltered","infoPostFix","thousands","lengthMenu","loadingRecords","processing","search","zeroRecords","paginate","first","last","next","previous","aria","sortAscending","sortDescending","setCreditday","importBill","imp_type","saveImportBill","alert","select","chkImportHeader","sessionStorage","setItem","removeItem","val1","val2","length","show","removeClass","remove","hide"],"sourceRoot":"","sources":["D:\\Project-vue\\SPR-PROJECT\\main-app-test\\src\\components\\showCustomer.vue"],"sourcesContent":["<template>\r\n     <Loading v-model:active=\"isLoading\" />\r\n     <div class=\"scroll\">\r\n          <!-- Modal สำหรับการสร้างใบรับ -->\r\n          <div class=\"modal fade rounded-3\" id=\"importHeader\" tabindex=\"-1\" aria-hidden=\"true\"\r\n               aria-labelledby=\"exampleModalLabel\">\r\n               <div class=\"modal-dialog modal-xl\" role=\"document\">\r\n                    <div class=\"modal-content\">\r\n                         <div class=\"modal-header bg-primary bg-opacity-75\" style=\"color: white\">\r\n                              <h1 class=\"modal-title fs-5\" style=\"color: white\" id=\"exampleModalLabel\">\r\n                                   ใบรับ\r\n                              </h1>\r\n                         </div>\r\n                         <div class=\"modal-body\">\r\n                              <!-- <form> -->\r\n                              <div class=\"row\">\r\n                                   <div class=\"col\" style=\"text-align: left\">\r\n                                        <label>ประเภทใบรับ</label>\r\n                                        <select class=\"form-select\" v-model=\"this.import_header.import_type_id\"\r\n                                             disabled>\r\n                                             <option value=\"1\">ค่าจ้าง</option>\r\n                                             <option value=\"2\">ยางพร้อมโครง</option>\r\n                                        </select>\r\n                                   </div>\r\n                                   <div class=\"col\" style=\"text-align: left\">\r\n                                        <label>เล่มที่</label>\r\n                                        <input type=\"text\" class=\"form-control\" id=\"book_id\"\r\n                                             v-model.trim=\"this.import_header.import_book_id\" />\r\n                                   </div>\r\n                                   <div class=\"col\" style=\"text-align: left\">\r\n                                        <label>เลขที่</label>\r\n                                        <input type=\"text\" class=\"form-control\" id=\"book_no\"\r\n                                             v-model.trim=\"this.import_header.import_book_no\" />\r\n                                   </div>\r\n                                   <div class=\"col\" style=\"text-align: left\">\r\n                                        <label>วันที่เปิดใบรับ</label>\r\n                                        <input type=\"text\" id=\"datepicker\" class=\"form-control\"\r\n                                             v-model=\"this.import_header.import_date\" @click.prevent=\"showDatePicker();\" />\r\n                                        <!-- <Datepicker v-model=\"this.import_header.import_date\" :format=\"format\"\r\n                                             autoApply /> -->\r\n                                   </div>\r\n                              </div>\r\n                              <div class=\"row mt-1\">\r\n                                   <div class=\"col\" style=\"text-align: left\">\r\n                                        <label>ชื่อลูกค้า</label>\r\n                                        <input type=\"text\" class=\"form-control\" v-model=\"this.tmp_cust_name\" />\r\n                                   </div>\r\n                              </div>\r\n                              <div class=\"row mt-1\">\r\n                                   <div class=\"col-8\" style=\"text-align: left\">\r\n                                        <label>ที่อยู่ลูกค้า</label>\r\n                                        <input type=\"text\" class=\"form-control\" v-model=\"this.tmp_cust_addr\" />\r\n                                   </div>\r\n                                   <div class=\"col-4\" style=\"text-align: left\">\r\n                                        <label>เบอร์โทร</label>\r\n                                        <input type=\"text\" class=\"form-control\" v-model=\"this.tmp_cust_tel\" />\r\n                                   </div>\r\n                              </div>\r\n                              <div class=\"row-12 mt-2\" style=\"text-align: center\">\r\n                                   <button type=\"button\" class=\"btn btn-danger rounded-2 me-2\"\r\n                                        @click.prevent=\"hideModal('importHeader')\">\r\n                                        <font-awesome-icon icon=\"fa-solid fa-ban\" />&nbsp;ปิดหน้าต่าง\r\n                                   </button>\r\n                                   <button type=\"button\" class=\"btn btn-primary rounded-2 me-2\"\r\n                                        @click.prevent=\"saveImportBill()\">\r\n                                        <font-awesome-icon icon=\"fa-solid fa-check-to-slot\" />&nbsp;บันทึกใบรับ\r\n                                   </button>\r\n                              </div>\r\n                              <!-- {{ this.import_header }} -->\r\n                              <!-- </form> -->\r\n                         </div>\r\n                    </div>\r\n               </div>\r\n          </div>\r\n          <!-- สิ้นสุดการสร้างใบรับ -->\r\n\r\n          <!-- Modal สำหรับการแก้ไขข้อมูล -->\r\n          <div class=\"modal fade rounded-3\" id=\"editCustModal\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\"\r\n               aria-hidden=\"true\">\r\n               <div class=\"modal-dialog modal-xl\" role=\"document\">\r\n                    <div class=\"modal-content\">\r\n                         <div class=\"modal-header bg-danger bg-opacity-75\">\r\n                              <h1 class=\"modal-title fs-5\" style=\"color: white\" id=\"exampleModalLabel\">\r\n                                   ดูรายละเอียด / แก้ไข\r\n                              </h1>\r\n                              <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"\r\n                                   aria-label=\"Close\"></button>\r\n                         </div>\r\n                         <div class=\"modal-body\">\r\n                              <form>\r\n                                   <div class=\"card-body\">\r\n                                        <div class=\"form-group\">\r\n                                             <div class=\"row\">\r\n                                                  <div class=\"col\">\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label style=\"color: red\">*รหัสลูกค้า</label>\r\n                                                            <input type=\"text\" class=\"form-control\"\r\n                                                                 v-model.trim=\"editCustomer.customerId\" disabled />\r\n                                                       </div>\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label style=\"color: red\">*ชื่อลูกค้า</label>\r\n                                                            <input type=\"text\" id=\"input_name\" class=\"form-control\"\r\n                                                                 v-model.trim=\"editCustomer.customerName\" />\r\n                                                       </div>\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label>ที่อยู่ลูกค้า</label>\r\n                                                            <input type=\"text\" class=\"form-control\"\r\n                                                                 v-model.trim=\"editCustomer.customerAddr\" />\r\n                                                       </div>\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label>จังหวัด</label>\r\n                                                            <select class=\"form-select\" id=\"findSelect\"\r\n                                                                 v-model=\"editCustomer.province_id\">\r\n                                                                 <option v-for=\"province in province_id\"\r\n                                                                      :key=\"province.PROVINCE_ID\"\r\n                                                                      :value=\"province.PROVINCE_ID\">\r\n                                                                      {{ province.PROVINCE_NAME }}\r\n                                                                 </option>\r\n                                                            </select>\r\n                                                       </div>\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label>รหัสไปรษณีย์</label>\r\n                                                            <input type=\"text\" class=\"form-control\"\r\n                                                                 v-model=\"editCustomer.postCode\" />\r\n                                                       </div>\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label>เบอร์โทรศัพท์</label>\r\n                                                            <input type=\"text\" class=\"form-control\"\r\n                                                                 v-model=\"editCustomer.customerTel\" />\r\n                                                       </div>\r\n                                                  </div>\r\n                                                  <div class=\"col-md-6\">\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label>ชื่อผู้ติดต่อ</label>\r\n                                                            <input type=\"text\" class=\"form-control\"\r\n                                                                 v-model=\"editCustomer.contactName\" />\r\n                                                       </div>\r\n\r\n                                                       <label>เบอร์โทรผู้ติดต่อ / ตำแหน่งงานผู้ติดต่อ</label>\r\n                                                       <div class=\"input-group mb-2\">\r\n                                                            <input type=\"text\" class=\"form-control\"\r\n                                                                 v-model=\"editCustomer.contactTel\" />\r\n                                                            <span class=\"input-group-text\">/</span>\r\n                                                            <input type=\"text\" class=\"form-control\"\r\n                                                                 v-model=\"editCustomer.contactPosition\" />\r\n                                                       </div>\r\n                                                       <div class=\"mb-2\">\r\n                                                            <label>ประเภทการชำระเงิน</label>\r\n                                                            <select class=\"form-select\" @change=\"setCreditday\"\r\n                                                                 v-model=\"editCustomer.payType\">\r\n                                                                 <option value=\"1\">เงินสด</option>\r\n                                                                 <option value=\"2\">เครดิต</option>\r\n                                                            </select>\r\n                                                       </div>\r\n                                                       <!-- ตรวจสอบสิทธิ์ในการเครดิต -->\r\n\r\n                                                       <div class=\"row border-0\" v-if=\"editCustomer.payType == 2\">\r\n                                                            <div class=\"col\">\r\n                                                                 <label>เครดิต (วัน)</label>\r\n                                                                 <div class=\"input-group\">\r\n                                                                      <input type=\"number\" class=\"form-control\"\r\n                                                                           v-model=\"editCustomer.creditDay\"\r\n                                                                           style=\"width: auto\" />\r\n                                                                      <!-- <span class=\"input-group-text\" style=\"width:100%;\">วัน</span> -->\r\n                                                                 </div>\r\n                                                            </div>\r\n                                                            <div class=\"col\">\r\n                                                                 <label>วงเงิน (บาท)</label>\r\n                                                                 <div class=\"input-group\">\r\n                                                                      <input type=\"number\" class=\"form-control\"\r\n                                                                           v-model=\"editCustomer.creditLimit\"\r\n                                                                           style=\"width: auto\" />\r\n                                                                      <!-- <span class=\"input-group-text\" style=\"width:100%;\">บาท</span> -->\r\n                                                                 </div>\r\n                                                            </div>\r\n                                                       </div>\r\n\r\n                                                       <!-- สิ้นสุดตรวจสอบสิทธิ์ในการเครดิต -->\r\n                                                       <div class=\"mb-2 mt-2\">\r\n                                                            <label>ประเภทราคาที่</label>\r\n                                                            <select class=\"form-select\"\r\n                                                                 v-model=\"editCustomer.priceType\">\r\n                                                                 <option value=\"1\">เงินสด</option>\r\n                                                                 <option value=\"2\">เงินสด+จัดส่ง</option>\r\n                                                                 <option value=\"3\">เครดิต</option>\r\n                                                                 <option value=\"4\">ราคาพิเศษ</option>\r\n                                                            </select>\r\n                                                       </div>\r\n                                                       <div class=\"mb-2\">\r\n                                                            <textarea class=\"form-control\"\r\n                                                                 placeholder=\"บันทึกเพิ่มเติมได้ที่นี่\"\r\n                                                                 v-model=\"editCustomer.remark\"\r\n                                                                 style=\"height: 80px\"></textarea>\r\n                                                            <label for=\"comment\">บันทึกเพิ่มเติม</label>\r\n                                                       </div>\r\n                                                  </div>\r\n                                             </div>\r\n                                        </div>\r\n                                   </div>\r\n                                   <!-- {{ editCustomer }} -->\r\n                              </form>\r\n                         </div>\r\n                         <div class=\"modal-footer\">\r\n                              <!-- ปุ่มปิด -->\r\n                              <button type=\"button\" class=\"btn btn-secondary btn-lg\"\r\n                                   @click.prevent=\"hideModal('editCustModal')\">\r\n                                   <font-awesome-icon icon=\"fa-solid fa-ban\" />\r\n                              </button>\r\n                              <!-- ปุ่มบันทึก -->\r\n                              <button id=\"btn\" class=\"btn btn-primary btn-lg\" @click.prevent=\"saveEditCustomer\">\r\n                                   <font-awesome-icon icon=\"fa-solid fa-circle-check\" />\r\n                              </button>\r\n                         </div>\r\n                    </div>\r\n               </div>\r\n          </div>\r\n          <!-- สิ้นสุดการแก้ไขข้อมูล(Modal) -->\r\n          <div class=\"card border-dark shadow overflow-auto\" style=\"width: 100%\">\r\n               <div class=\"card-header bg-primary\" style=\"color: white\">\r\n                    ::: แสดงรายการ-ลูกค้า :::\r\n               </div>\r\n               <div class=\"card-body\">\r\n                    <table id=\"showcustomer\" class=\"ms-2 table table-striped table-hover table-sm nowrap\"\r\n                         style=\"width: 90%; align-items: center\">\r\n                         <thead>\r\n                              <tr>\r\n                                   <th style=\"text-align: right\">\r\n                                        <button class=\"btn btn-success btn-sm\" title=\"เพิ่มข้อมูล\"\r\n                                             @click=\"newCustomer()\">\r\n                                             <!-- ปุ่มเพิ่มข้อมูล -->\r\n                                             <!-- <font-awesome-icon icon=\"fa-solid fa-plus\" /> -->\r\n                                             <font-awesome-icon icon=\"fa-solid fa-user-plus\" />\r\n                                        </button>\r\n                                   </th>\r\n                                   <th></th>\r\n                                   <th>รหัสลูกค้า</th>\r\n                                   <th>ชื่อลูกค้า</th>\r\n                                   <th>ที่อยู่ลูกค้า</th>\r\n                                   <th>เบอร์ติดต่อ</th>\r\n                                   <th>จังหวัด</th>\r\n                              </tr>\r\n                         </thead>\r\n                         <tbody class=\"table-group-divider\">\r\n                              <tr v-for=\"rec in data_row\" :key=\"rec.customerId\">\r\n                                   <td style=\"text-align: right\">\r\n                                        <button id=\"edit\" class=\"btn btn-primary btn-sm\" title=\"แก้ไขข้อมูล\"\r\n                                             @click.prevent=\"editCustomer_Modal(rec)\">\r\n                                             <font-awesome-icon icon=\"fa-solid fa-user-pen\" />\r\n                                        </button>\r\n                                   </td>\r\n                                   <td style=\"text-align: left\">\r\n                                        <button class=\"btn btn-info btn-sm\" title=\"ทำใบรับ\"\r\n                                             @click.prevent=\"showDatePicker();importBill(rec)\">\r\n                                             <font-awesome-icon icon=\"fa-regula fa-file-lines\" />\r\n                                        </button>\r\n                                   </td>\r\n                                   <td @click.prevent=\"editCustomer_Modal(rec)\">{{ rec.customerId }}</td>\r\n                                   <td @click.prevent=\"editCustomer_Modal(rec)\">{{ rec.customerName }}</td>\r\n                                   <td @click.prevent=\"editCustomer_Modal(rec)\">{{ rec.customerAddr }}</td>\r\n                                   <td @click.prevent=\"editCustomer_Modal(rec)\">{{ rec.customerTel }}</td>\r\n                                   <td @click.prevent=\"editCustomer_Modal(rec)\">{{ rec.PROVINCE_NAME }}</td>\r\n                              </tr>\r\n                         </tbody>\r\n                    </table>\r\n               </div>\r\n          </div>\r\n     </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"@/axios\";\r\nimport $ from \"jquery\";\r\nimport { Modal } from \"bootstrap\";\r\nimport { ref } from \"vue\";\r\n\r\nexport default {\r\n     setup() {\r\n          const date = ref(new Date());\r\n          const format = (date) => {\r\n               const d = date.getDate();\r\n               const m = date.getMonth() + 1;\r\n               const y = date.getFullYear();\r\n               return `${d}/${m}/${y}`;\r\n          }\r\n          return {\r\n               date, format\r\n          }\r\n     },\r\n     data() {\r\n          return {\r\n               isLoading: false,\r\n               data_row: [],\r\n               province_id: [],\r\n               check_bill_header: \"\",\r\n               newRec: {\r\n                    customerId: \"\",\r\n                    customerName: \"\",\r\n                    customerAddr: \"\",\r\n                    province_id: \"\",\r\n                    postCode: \"\",\r\n                    customerTel: \"\",\r\n                    contactName: \"\",\r\n                    contactTel: \"\",\r\n                    contactPosition: \"\",\r\n                    payType: \"\",\r\n                    creditDay: \"\",\r\n                    creditLimit: \"\",\r\n                    priceType: \"\",\r\n                    remark: \"\",\r\n                    customerDel: \"\",\r\n               },\r\n               editCustomer: {\r\n                    customerId: \"\",\r\n                    customerName: \"\",\r\n                    customerAddr: \"\",\r\n                    province_id: \"\",\r\n                    postCode: \"\",\r\n                    customerTel: \"\",\r\n                    contactName: \"\",\r\n                    contactTel: \"\",\r\n                    contactPosition: \"\",\r\n                    payType: \"\",\r\n                    creditDay: \"\",\r\n                    creditLimit: \"\",\r\n                    priceType: \"\",\r\n                    remark: \"\",\r\n                    customerDel: \"\",\r\n               },\r\n               // temp\r\n               tmp_cust_name: \"\",\r\n               tmp_cust_addr: \"\",\r\n               tmp_cust_tel: \"\",\r\n               import_header: {\r\n                    import_book_id: \"\",\r\n                    import_book_no: \"\",\r\n                    cust_auto_id: \"\",\r\n                    import_user: 1,\r\n                    import_type_id: \"\",\r\n                    import_date: \"\",\r\n                    import_status: \"รอดำเนินการ\",\r\n               },\r\n          };\r\n     },\r\n     created() {\r\n          this.getData();\r\n     },\r\n     methods: {\r\n          onSelect2() {\r\n               $(document).ready(() => {\r\n                    let rec = this.editCustomer;\r\n                    $(\"#findSelect\").select2({\r\n                         theme: \"bootstrap-5\",\r\n                         closeOnSelect: true,\r\n                         width: \"100%\",\r\n                         dropdownParent: $(\"#findSelect\").parent(),\r\n                         placeholder: \"--- เลือกจังหวัด ---\",\r\n                         // tags: true,\r\n                    });\r\n                    $(\"#findSelect\").on(\"select2:select\", function (e) {\r\n                         let data = e.params.data;\r\n                         rec.province_id = data.id;\r\n                    });\r\n               });\r\n          },\r\n          showDatePicker() {\r\n               let data = this.import_header;\r\n               $(document).ready(() => {\r\n                    $('#datepicker').datepicker({\r\n                         format: \"dd/mm/yyyy\",\r\n                         autoclose: true,\r\n                         templates: \"bootstrap-5\",\r\n                         toggleActive: true,\r\n                    });\r\n                    $('#datepicker').change(() => {\r\n                         data.import_date = $('#datepicker').val();\r\n                    })\r\n               });\r\n          },\r\n          goLoading() {\r\n               this.isLoading = true;\r\n               setTimeout(() => {\r\n                    this.isLoading = false;\r\n               }, 5000);\r\n          },\r\n          inputFocus(Modal, InputModal) {\r\n               const myModal = document.getElementById(Modal);\r\n               const myInput = document.getElementById(InputModal);\r\n               myModal.addEventListener(\"shown.bs.modal\", () => {\r\n                    myInput.focus();\r\n               });\r\n          },\r\n          newCustomer() {\r\n               this.$router.push(\"/newcustomer\");\r\n          },\r\n          async editCustomer_Modal(val) {\r\n               this.editCustomer.customerId = await val.customerId;\r\n               this.editCustomer.customerName = await val.customerName;\r\n               this.editCustomer.customerAddr = await val.customerAddr;\r\n               this.editCustomer.province_id = await val.province_id;\r\n               this.editCustomer.postCode = await val.postCode;\r\n               this.editCustomer.customerTel = await val.customerTel;\r\n               this.editCustomer.contactName = await val.contactName;\r\n               this.editCustomer.contactTel = await val.contactTel;\r\n               this.editCustomer.contactPosition = await val.contactPosition;\r\n               this.editCustomer.payType = await val.payType;\r\n               this.editCustomer.creditDay = await val.creditDay;\r\n               this.editCustomer.creditLimit = await val.creditLimit;\r\n               this.editCustomer.priceType = await val.priceType;\r\n               this.editCustomer.remark = await val.remark;\r\n               this.editCustomer.customerDel = await val.customerDel;\r\n               await this.showModal(\"editCustModal\");\r\n               await this.onSelect2();\r\n               //this.inputFocus(\"editCustModal\", \"input_name\");\r\n          },\r\n          async saveNewrec() {\r\n               // await axios.post(`${apiURL}/customer/new`, this.newRec).then(() => {\r\n               await axios.post(`customer/new`, this.newRec).then(() => {\r\n                    this.newRec = {\r\n                         customerId: \"\",\r\n                         customerName: \"\",\r\n                         customerAddr: \"\",\r\n                         province_id: \"\",\r\n                         postCode: \"\",\r\n                         customerTel: \"\",\r\n                         contactName: \"\",\r\n                         contactTel: \"\",\r\n                         contactPosition: \"\",\r\n                         payType: \"\",\r\n                         creditDay: \"\",\r\n                         creditLimit: \"\",\r\n                         priceType: \"\",\r\n                         remark: \"\",\r\n                         customerDel: \"\",\r\n                    };\r\n                    this.$router.push(\"/showcustomer\");\r\n                    console.log(\"Process success!\");\r\n               })\r\n                    .catch((error) => {\r\n                         console.log(error);\r\n                    });\r\n               this.$router.push(\"/\");\r\n          },\r\n          async saveEditCustomer() {\r\n               //let editModal = document.getElementById('editCustModal')\r\n               if (confirm(\"ยืนยันการเปลี่ยนแปลงข้อมูล ?\") == true) {\r\n                    await axios.post(`customer/update`, this.editCustomer).then(() => {\r\n                         this.editCustomer = {\r\n                              customerId: \"\",\r\n                              customerName: \"\",\r\n                              customerAddr: \"\",\r\n                              province_id: \"\",\r\n                              postCode: \"\",\r\n                              customerTel: \"\",\r\n                              contactName: \"\",\r\n                              contactTel: \"\",\r\n                              contactPosition: \"\",\r\n                              payType: \"\",\r\n                              creditDay: \"\",\r\n                              creditLimit: \"\",\r\n                              priceType: \"\",\r\n                              remark: \"\",\r\n                              customerDel: \"\",\r\n                         };\r\n                         this.hideModal(\"editCustModal\");\r\n                         // ---------------------------------\r\n                         $(\"#showcustomer\").DataTable().destroy(); //--- ทำลาย Datatable\r\n                         this.getData();\r\n                         console.log(\"Process success!\");\r\n                    })\r\n                         .catch((error) => {\r\n                              console.log(error);\r\n                         });\r\n               }\r\n          },\r\n          async getData() {\r\n               this.goLoading();\r\n               await axios.get(`customer/read`).then((response) => {\r\n                    this.data_row = response.data;\r\n                    $(document).ready(function () {\r\n                         $(\"#showcustomer\").DataTable({\r\n                              // \"fnRowCallback\": function (nRow, aData,) { // เช็คเงื่อนไขในแต่ละเรคคอร์ด\r\n                              //      if (aData[3] == \"handsome\") {\r\n                              //           $('td', nRow).css('color', 'Red');\r\n                              //      }\r\n                              // }\r\n                              //\"dom\": 'Bfrtip',\r\n                              //\"buttons\": ['excel', 'pdf'],\r\n                              scrollY: \"300px\",\r\n                              // \"scrollX\": false,\r\n                              // scrollCollapse: true,\r\n                              // paging: false,\r\n                              // rowReorder: true,\r\n                              // \"bJQueryUI\": true,\r\n                              autoFill: true,\r\n                              sPaginationType: \"full_numbers\",\r\n                              language: {\r\n                                   decimal: \"\",\r\n                                   emptyTable: \"ไม่พบการข้อมูลจากฐานข้อมูล\",\r\n                                   info: \"พบข้อมูล _TOTAL_ เรคอร์ด\",\r\n                                   // \"info\": \"แสดง _START_ - _END_ แถว จากทั้งหมด _TOTAL_ แถว\",\r\n                                   infoEmpty: \"ไม่พบข้อมูลที่ค้นหา\",\r\n                                   infoFiltered: \"(จากข้อมูลทั้งหมด _MAX_ เรคอร์ด)\",\r\n                                   infoPostFix: \"\",\r\n                                   thousands: \",\",\r\n                                   lengthMenu: \"แสดงครั้งละ _MENU_ เรคอร์ด\",\r\n                                   loadingRecords: \"Loading...\",\r\n                                   processing: \"\",\r\n                                   search: \"ค้นหาข้อมูล:\",\r\n                                   zeroRecords: \"ไม่พบข้อมูลที่ค้นหา\",\r\n                                   paginate: {\r\n                                        first: \"หน้าแรก\",\r\n                                        last: \"หน้าสุดท้าย\",\r\n                                        next: \"ต่อไป\",\r\n                                        previous: \"ย้อนกลับ\",\r\n                                   },\r\n                                   aria: {\r\n                                        sortAscending: \": activate to sort column ascending\",\r\n                                        sortDescending: \": activate to sort column descending\",\r\n                                   },\r\n                              },\r\n                         });\r\n                    });\r\n               });\r\n               await axios.get(`province/read`).then((response) => {\r\n                    this.province_id = response.data;\r\n               });\r\n          },\r\n          setCreditday() {\r\n               if (this.editCustomer.payType == 1) {\r\n                    this.editCustomer.creditDay = 0;\r\n                    this.editCustomer.creditLimit = 0;\r\n                    this.editCustomer.priceType = 1;\r\n               } else {\r\n                    this.editCustomer.creditDay = 30;\r\n                    this.editCustomer.creditLimit = 0;\r\n                    this.editCustomer.priceType = 3;\r\n               }\r\n          },\r\n          importBill(val) {\r\n               // sessionStorage.setItem(\"cust_id\", val.cust_auto_id);\r\n               // this.$router.push(\"/importWork\");\r\n               let imp_type;\r\n               if (val.cust_auto_id == 1) {\r\n                    imp_type = 2;\r\n               } else {\r\n                    imp_type = 1;\r\n               }\r\n               this.tmp_cust_name = val.customerName;\r\n               this.tmp_cust_addr = val.customerAddr;\r\n               this.tmp_cust_tel = val.customerTel;\r\n               this.import_header.cust_auto_id = val.cust_auto_id;\r\n               this.import_header.import_type_id = imp_type;\r\n               this.showModal(\"importHeader\");\r\n          },\r\n          async saveImportBill() {\r\n               if (this.import_header.import_book_id == \"\" ||\r\n                    this.import_header.import_book_no == \"\" ||\r\n                    this.import_header.import_date == \"\") {\r\n                    alert(\"กรุณากรอกข้อมูลให้ครบถ้วน(เล่มที่, เลขที่ หรือ วันที่) !!!\");\r\n                    document.getElementById(\"book_id\").focus();\r\n                    document.getElementById(\"book_id\").select();\r\n               }\r\n               else {\r\n                    await this.chkImportHeader(this.import_header.import_book_id, this.import_header.import_book_no);\r\n                    if (await this.check_bill_header == 0) {\r\n                         if (await confirm(\"ยืนยันการสร้างใบรับ\") == true) {\r\n                              await sessionStorage.setItem('import_book_id', this.import_header.import_book_id);\r\n                              await sessionStorage.setItem('import_book_no', this.import_header.import_book_no);\r\n                              await axios.post(`billimport/new`, this.import_header).then(() => {\r\n                                   this.import_header = {\r\n                                        import_book_id: \"\",\r\n                                        import_book_no: \"\",\r\n                                        cust_auto_id: \"\",\r\n                                        import_user: \"\",\r\n                                        import_type_id: \"\",\r\n                                        import_date: new Date(),\r\n                                        import_status: \"รอดำเนินการ\",\r\n                                   };\r\n                              }).catch((error) => { console.log(error); });\r\n                              if (await confirm(\"บันทึกข้อมูลสำเร็จ...ต้องการเพิ่มรายการในบิลเลยหรือไม่?\") == true) {\r\n                                   this.hideModal(\"importHeader\");\r\n                                   this.$router.push(\"/importWork\");\r\n                              } else {\r\n                                   await sessionStorage.removeItem('import_book_id');\r\n                                   await sessionStorage.removeItem('import_book_no');\r\n                                   await this.hideModal(\"importHeader\");\r\n                              }\r\n                         }\r\n                    }\r\n                    else\r\n                         alert(\"ไม่สามารถใช้หมายเลขเล่ม และเลขบิลนี้ได้ กรุณาตรวจสอบ !!!\");\r\n\r\n               }\r\n          },\r\n          async chkImportHeader(val1, val2) {\r\n               await axios.get(`billimport/search/${val1}/${val2}`).then((response) => {\r\n                    this.check_bill_header = response.data.length;\r\n               });\r\n          },\r\n          async showModal(e) {\r\n               let myModal = await new Modal(document.getElementById(e));\r\n               await myModal.show();\r\n          },\r\n          async hideModal(e) {\r\n               await $(`#${e}`).removeClass(\"in\");\r\n               await $(\".modal-backdrop\").remove();\r\n               await $(`#${e}`).hide();\r\n          },\r\n     },\r\n};\r\n</script>\r\n\r\n<style>\r\n.scroll {\r\n     flex: 1;\r\n     display: flex;\r\n     flex-wrap: nowrap;\r\n     overflow-x: auto;\r\n}\r\n\r\n.card {\r\n     flex: auto;\r\n     flex-shrink: 0;\r\n     max-width: auto;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}